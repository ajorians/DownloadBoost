name: 'Boost Prebuild With MSVC'

#on: workflow_dispatch

on:
  push:
    branches:
      - master
env:
  OutputBranchName: release2
  BoostDownloadURL: http://test.orians.org/boost_1_81_0.zip
#http://test.orians.org/boost_test.zip

jobs:
  Prebuild-Boost:
    runs-on: windows-latest
    env:
      ZipName: boost
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Initialize mandatory git config
        run: |
          git config user.name "A.J. Orians"
          git config user.email ajorians@gmail.com
      - name: Create release branch
        run: git checkout -b $OutputBranchName
      - name: Download
        shell: powershell
        run: Invoke-WebRequest -Uri "$env:BoostDownloadURL" -OutFile "$env:ZipName.zip"
      - name: Extract Zip file
        shell: cmd
        run: |
          7z x -y %ZipName%.zip
          del %ZIPname%.zip
      - name: Bootstrap Boost
        shell: cmd
        run: |
          cd boost_1_81_0
          dir
          bootstrap
      - name: Build Boost
        shell: cmd
        run: |
          cd boost_1_81_0
          dir
          .\b2
      - name: Prepare Includes
        run: |
          dir
          mkdir include
          move boost_1_81_0\boost include
          git add include
          git commit --message "Added Includes"
      - name: Push new branch
        run: git push origin $OutputBranchName
